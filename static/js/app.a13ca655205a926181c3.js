webpackJsonp([1],{0:function(e,t){},"0bdn":function(e,t){},"4WUo":function(e,t){},"5JrK":function(e,t){},DUSY:function(e,t){},K6Ts:function(e,t){},P9az:function(e,t){},PNa4:function(e,t){},ceto:function(e,t){},"d8/S":function(e,t){},"f/sI":function(e,t){},fKq1:function(e,t){},fUP9:function(e,t){},g7Mu:function(e,t){},gPkN:function(e,t){},tvR6:function(e,t){},u1Ef:function(e,t){},u9lV:function(e,t){},x35b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),r=n("u0hM"),i={user:void 0,accessToken:void 0,expirationTime:void 0},o=Object(r.a)().module("auth",i);function a(e,t){Object.assign(e,t)}var u=o.state(),l={get state(){return u()},commitAuthorized:o.commit(function c(e,t){console.log("authorized",t.user),a(e,t)},"authorized"),commitTokenReceived:o.commit(function m(e,t){console.log("tokenReceived"),a(e,t)},"tokenReceived"),commitLogout:o.commit(function d(e){console.log("logout",l.state.user.username),Object.assign(e,i)},"logout")},f=l,p={ref:"asideMenu",router:!0,items:[{index:"/",title:"Main",icon:"el-icon-menu"},{index:"/users",title:"Users",icon:"fas fa-users"},{index:"/transactions",title:"Transactions",icon:"el-icon-tickets"},{index:"/accounts",title:"Accounts",icon:"el-icon-goods",subitems:[{index:"/accounts-income",title:"Income",icon:"el-icon-goods el-icon--green"},{index:"/accounts-current",title:"Current",icon:"el-icon-goods el-icon--blue"},{index:"/accounts-expense",title:"Expense",icon:"el-icon-goods el-icon--red"}]}]},h=s.default.extend({name:"TheAside",data:function(){return{activeIndex:this.$router.currentRoute.path,isCollapse:window.innerWidth<=768,asideMenu:p}},created:function(){var e=this;window.onresize=function(){e.isCollapse=window.innerWidth<=768}},mounted:function(){"Accounts"!==this.$router.currentRoute.name||this.isCollapse||this.$refs.asideMenu.open("/accounts")},destroyed:function(){window.onresize=null},watch:{$route:function(e,t){"Accounts"!==e.name&&this.$refs.asideMenu.close("/accounts"),this.activeIndex=e.path}}}),g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.asideMenu?n("el-aside",[n("el-menu",{ref:e.asideMenu.ref,attrs:{"default-active":e.activeIndex,router:e.asideMenu.router,collapse:e.isCollapse}},[e._l(e.asideMenu.items,function(t){return[t.subitems?[e.isCollapse?e._l(t.subitems,function(t){return n("el-menu-item",{key:t.index,attrs:{index:t.index}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])])}):[n("el-submenu",{attrs:{index:t.index}},[n("template",{slot:"title"},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])]),e._v(" "),e._l(t.subitems,function(t){return[n("el-menu-item",{attrs:{index:t.index}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])])]})],2)]]:[n("el-menu-item",{attrs:{index:t.index}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])])]]})],2)],1):e._e()},staticRenderFns:[]};var v=n("VU/8")(h,g,!1,function b(e){n("ceto")},"data-v-54d161b9",null).exports,_=n("UMwo"),x=n.n(_),w=n("zL8q"),F=n.n(w),k=n("Au9i"),y=n.n(k),q=new x.a(navigator.userAgent),U=function(){function e(){}return e.showError=function(e){w.Message.error(e.name+": "+e.message)},e.showConfirmMessage=function(e,t){var n={confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"};return q.phone()?k.MessageBox.confirm(t,e,n):w.MessageBox.confirm(t,e,n)},e}(),A=n("/ocq"),R=n("mtWM"),M=n.n(R),C=function(){function e(){}return e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),E=M.a.create();function $(e){var t=f.state.accessToken;return t&&(e.headers.Authorization="Bearer "+t),e}function P(e){return Promise.reject(e)}E.defaults.baseURL="https://server.grigoblin.ru",E.interceptors.request.use(function(e){switch(C.log("send request",e.method,e.url),e.url){case"/auth/login":return e;case"/auth/token":return $(e);default:return T.checkLifetime().then(function(){return $(e)}).catch(P)}},P),E.interceptors.response.use(function(e){return C.log(e.config.method+" "+e.config.url+" response:"),C.log(e),e},function(e){return e.response&&401===e.response.status&&(f.commitLogout(),Te.push({name:"Login"})),P(e)});var L=function(){function e(){}return e.login=function(e,t){var n={username:e,password:t,userAgent:navigator.userAgent};return E.post("/auth/login",n).then(function(e){return f.commitAuthorized(e.data)}).catch(P)},e.exchangeToken=function(){return E.get("/auth/token").then(function(e){return f.commitTokenReceived(e.data)}).catch(P)},e.register=function(e,t,n){var s={username:e,password:t,roles:n};return E.post("/auth/register",s).catch(P)},e.getUsers=function(){return E.get("/api/users").then(function(e){return e.data.users}).catch(P)},e.getUserById=function(e){return E.get("/api/users/"+e).then(function(e){return e.data.user}).catch(P)},e.deleteUser=function(e){return E.delete("/api/users/"+e).then(function(e){return e.data}).catch(P)},e.getRoles=function(){return E.get("/api/roles").then(function(e){return e.data.roles}).catch(P)},e}(),T=function(){function e(){}return e.checkLifetime=function(){return new Promise(function(e,t){var n=function(e){return console.error(e.name+": "+e.message),t(e)};if(!f.state.expirationTime)return n(new Error("have no expirationTime"));var s=new Date(1e3*f.state.expirationTime).getTime(),r=(new Date).getTime();if(s<r)return n(new Error("token expire"));return Math.floor((s-r)/1e3)>86400?e():(console.log("token expire at",new Date(s)),console.log("have to exchange access token"),L.exchangeToken().then(function(t){return e(t)}).catch(function(e){return n(e)}))})},e}(),S=s.default.extend({name:"Main"}),V={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"main-content"},[t("h1",[this._v("Main")]),this._v(" "),t("p",[this._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque id nulla dolor. Aliquam volutpat non eros nec mattis. Nam gravida, justo quis tincidunt blandit, urna magna faucibus lectus, sit amet volutpat nulla lorem quis leo. Duis nec dolor sagittis, tincidunt metus at, vehicula leo. Quisque suscipit nec ipsum in bibendum. Sed posuere, massa at faucibus elementum, nunc magna fringilla turpis, vitae ullamcorper augue elit at arcu. Sed et ligula eu lorem efficitur feugiat. Nam mollis mauris laoreet magna facilisis convallis. Morbi condimentum augue enim, vel bibendum eros congue ac. Suspendisse tincidunt posuere mi, quis volutpat ipsum vulputate quis. Etiam eget libero non turpis efficitur laoreet. Sed posuere nibh nulla, eu consequat diam mollis nec. Nulla justo ex, suscipit eget aliquet eu, malesuada vel neque.\n\n        Integer sed sem a mauris lobortis accumsan vel non ipsum. Curabitur in mauris ac lectus accumsan dictum a vitae lectus. Sed quis leo leo. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Etiam pretium ex ac purus molestie, ut auctor lectus pretium. Phasellus ultrices in risus ut cursus. Mauris porttitor, odio ut luctus scelerisque, risus velit convallis libero, a aliquet ligula justo vitae sapien. Integer convallis metus mauris, vitae interdum neque elementum eu. Aliquam vitae nulla vitae nulla fermentum dignissim in sed lacus. Sed congue efficitur ex, tristique dictum nulla aliquet sit amet. Cras euismod dui ac felis fringilla, lacinia sollicitudin sem porttitor. Vivamus ac maximus mauris. Donec ut augue tristique, tincidunt leo in, mollis ante. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Suspendisse sodales tristique fermentum.\n\n        Cras non dolor in erat euismod scelerisque. Fusce lectus ligula, cursus ac feugiat sit amet, maximus id dui. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed interdum, dui id egestas luctus, mi massa tincidunt leo, sed cursus metus ante sed ex. Cras iaculis eu turpis quis blandit. Suspendisse feugiat mauris sit amet erat pellentesque, quis mollis elit tristique. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;\n\n        Nunc at augue vitae ex hendrerit condimentum. Donec nec ex nec sapien egestas cursus a euismod nisl. Donec accumsan ipsum eu varius lacinia. Phasellus pretium mauris accumsan dui pretium eleifend. Curabitur tristique orci magna, eget tempus tortor congue sed. Phasellus egestas quam vitae turpis posuere, sit amet pretium nisl auctor. Aenean eget mollis tellus. Vestibulum egestas vulputate nisl, quis commodo eros venenatis ut. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Duis at ante vitae ipsum viverra faucibus at vitae diam. Vivamus varius pharetra enim, et aliquet augue suscipit a. Donec vitae tincidunt massa. In nisl odio, sollicitudin et ultrices eget, rhoncus id nunc. Integer at ornare massa.\n\n        Vestibulum non sagittis tellus, at cursus lectus. Phasellus eros sem, malesuada et leo ut, efficitur eleifend nisl. Nunc risus mauris, dignissim id auctor sit amet, laoreet vitae lorem. Mauris auctor cursus purus, vitae tincidunt nibh blandit nec. Nulla placerat efficitur erat, at molestie purus convallis sed. Mauris egestas metus vel dolor cursus, a gravida risus efficitur. Sed congue odio a nulla pulvinar maximus. Nam vel lectus nec dui commodo eleifend. Donec consequat, ligula finibus tempor aliquet, odio risus euismod massa, eget vestibulum nisl turpis eu orci. Etiam erat est, mattis eget ultrices id, finibus a dolor. Integer pellentesque tellus enim, sit amet sollicitudin urna pharetra id. Morbi id sodales tellus, quis porttitor arcu. Ut venenatis scelerisque magna ac aliquam.\n\n    ")])])}]};var D=n("VU/8")(S,V,!1,function N(e){n("P9az")},"data-v-59a2adc7",null).exports,I=s.default.extend({name:"Login",data:function(){return{loginForm:{username:"",password:""},busy:!1,rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"}]}}},methods:{submitForm:function(){var e=this;this.$refs.loginForm.validate().then(function(){e.busy=!0,L.login(e.loginForm.username,e.loginForm.password).then(function(){return e.$router.push({name:"Main"})}).catch(U.showError).then(function(){return e.busy=!1})}).catch(function(){return console.error("login form validation fail")})}}}),j={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],ref:"loginForm",attrs:{model:e.loginForm,rules:e.rules},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitForm(t):null}}},[n("h1",[e._v("Login page")]),e._v(" "),n("el-form-item",{attrs:{prop:"username"}},[n("el-input",{attrs:{placeholder:"Username"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("Login")])],1)],1)},staticRenderFns:[]};var z=n("VU/8")(I,j,!1,function O(e){n("u1Ef")},"data-v-97f9f9b6",null).exports,B=function(e){return e.roles.split(",").includes("admin")},W=s.default.extend({name:"Profile",data:function(){return{user:{},editMode:!1,profileForm:{username:"",password:""},busy:!1,rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{min:1,message:"Please enter password",trigger:"blur"}]},isAdmin:!1,isSelf:!1}},props:["id"],created:function(){this.isAdmin=B(f.state.user),this.setupComponent()},methods:{setupComponent:function(){var e=this;this.isSelf=this.id===f.state.user.id,this.isAdmin&&this.id&&!this.isSelf?L.getUserById(this.id).then(function(t){t?(e.user=t,e.profileForm.username=e.user.username):e.profileForm.username=f.state.user.username}).catch(function(e){return console.error(e.message)}):(this.user=f.state.user,this.profileForm.username=f.state.user.username)},editButtonPressed:function(){this.editMode=this.isAdmin},deleteButtonPressed:function(){var e=this;U.showConfirmMessage("Delete confirmation","Are you sure to delete this user?").then(function(){L.deleteUser(e.id).then(function(){return e.$router.push({name:"Users"})}).catch(U.showError)}).catch()},submitForm:function(){console.log("submitForm")},cancelForm:function(){this.editMode=!1}},watch:{$route:function(e,t){t.params.id!==e.params.id&&this.setupComponent()}}}),K={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"el-card--username"},[e._v(e._s(e.user.username))]),e._v(" "),e.isAdmin&&!e.editMode?n("el-button",{staticClass:"el-button--edit",attrs:{type:"text"},on:{click:e.editButtonPressed}},[e._v("\n                Edit\n            ")]):e._e()],1),e._v(" "),e.editMode?[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],ref:"profileForm",attrs:{model:e.profileForm,rules:e.rules},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitForm(t):null}}},[n("el-form-item",{attrs:{prop:"username",label:"You can change username"}},[n("el-input",{attrs:{placeholder:"Username"},model:{value:e.profileForm.username,callback:function(t){e.$set(e.profileForm,"username",t)},expression:"profileForm.username"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password",label:"… and password"}},[n("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.profileForm.password,callback:function(t){e.$set(e.profileForm,"password",t)},expression:"profileForm.password"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("Update profile")]),e._v(" "),n("el-button",{on:{click:e.cancelForm}},[e._v("Cancel")])],1)],1)]:e._l(e.user,function(t,s){return n("div",{key:s},[e._v("\n                "+e._s(s+": "+("exp"===s?new Date(1e3*t):t))+"\n            ")])})],2),e._v(" "),e.isAdmin&&!e.isSelf?n("el-button",{staticClass:"el-button--delete",attrs:{type:"danger"},on:{click:e.deleteButtonPressed}},[e._v("\n        Delete user\n    ")]):e._e()],1)},staticRenderFns:[]};var Y=n("VU/8")(W,K,!1,function G(e){n("f/sI")},"data-v-d5239816",null).exports,H=s.default.extend({name:"Settings"}),J={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Settings")])},staticRenderFns:[]};var Q=n("VU/8")(H,J,!1,function Z(e){n("0bdn")},"data-v-6e43dc09",null).exports,X=s.default.extend({name:"Accounts"}),ee={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Accounts")])},staticRenderFns:[]};var te=n("VU/8")(X,ee,!1,function ne(e){n("fUP9")},"data-v-5026bd74",null).exports,se=s.default.extend({name:"AccountsIncome"}),re={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Accounts.Income")])},staticRenderFns:[]};var ie=n("VU/8")(se,re,!1,function oe(e){n("gPkN")},"data-v-5f3c8e65",null).exports,ae=s.default.extend({name:"AccountsCurrent"}),ue={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Accounts.Current")])},staticRenderFns:[]};var le=n("VU/8")(ae,ue,!1,function ce(e){n("4WUo")},"data-v-04ca59e2",null).exports,me=s.default.extend({name:"AccountsExpense"}),de={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Accounts.Expense")])},staticRenderFns:[]};var fe=n("VU/8")(me,de,!1,function pe(e){n("DUSY")},"data-v-3bdb6f5c",null).exports,he=s.default.extend({name:"Transactions"}),ge={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Transactions")])},staticRenderFns:[]};var ve=n("VU/8")(he,ge,!1,function be(e){n("fKq1")},"data-v-35ca4e52",null).exports,_e=Object(r.a)().module("roles",{rolesList:[]});var xe=_e.state(),we={get state(){return xe()},commitFillUpRolesList:_e.commit(function Fe(e,t){e.rolesList=t},"fillUpRolesList"),dispatchGetRoles:_e.dispatch(function ke(){L.getRoles().then(function(e){return we.commitFillUpRolesList(e)}).catch(function(e){return C.error(e.message)})})},ye=we,qe=s.default.extend({name:"Users",data:function(){return{user:f.state.user,busy:!1,usersData:[],isAdmin:!1}},created:function(){var e=this;ye.dispatchGetRoles(),this.isAdmin=B(this.user),this.isAdmin?(this.busy=!0,L.getUsers().then(function(t){return e.usersData=t}).catch(U.showError).then(function(){return e.busy=!1})):this.usersData=[this.user]},computed:{isMobile:function(){return window.innerWidth<=768},tableFields:function(){return[{prop:"id",label:"Id",minWidth:60,fixed:!0,sortable:!0},{prop:"username",label:"Name",minWidth:90,sortable:!0},{prop:"roles",label:"Roles",filters:ye.state.rolesList.map(function(e){return{text:e.rolename,value:e.rolename}}),filterMethod:function(e,t){return t.roles.split(",").includes(e)}}]}},methods:{detailClick:function(e){this.$router.push({name:"Profile",params:{id:e}})},addNewUser:function(){this.$router.push({name:"Register"})},filterRole:function(e,t){return t.role===e}}}),Ue={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],attrs:{data:e.usersData,"default-sort":{prop:"id",order:"ascending"},height:e.isMobile?300:500}},[e._l(e.tableFields,function(e){return n("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,fixed:e.fixed,width:e.width,"min-width":e.minWidth,sortable:e.sortable,formatter:e.formatter,filters:e.filters,"filter-method":e.filterMethod,"filter-placement":"bottom-end"}})}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",width:e.isMobile?50:96},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.detailClick(t.row.id)}}},[e._v("Detail")])]}}])})],2),e._v(" "),e.isAdmin?n("el-button",{staticClass:"el-button--new-user",attrs:{type:"primary"},on:{click:e.addNewUser}},[e._v("\n        Add new user\n    ")]):e._e()],1)},staticRenderFns:[]};var Ae=n("VU/8")(qe,Ue,!1,function Re(e){n("x8S2")},"data-v-a6587626",null).exports,Me=s.default.extend({name:"Register",data:function(){return{busy:!1,registerForm:{username:"",password:"",roles:[]},rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"}],roles:[{required:!0,message:"Please select roles",trigger:"blur"}]},rolesList:ye.state.rolesList}},created:function(){ye.dispatchGetRoles()},methods:{submitForm:function(){var e=this;this.$refs.registerForm.validate().then(function(){e.busy=!0;var t=e.registerForm;L.register(t.username,t.password,t.roles).then(function(){return e.$router.push({name:"Users"})}).catch(U.showError).then(function(){return e.busy=!1})}).catch(function(){return console.error("register form validation fail")})}}}),Ce={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.busy,expression:"busy"}],ref:"registerForm",attrs:{model:e.registerForm,rules:e.rules},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.submitForm(t):null}}},[n("el-form-item",{attrs:{prop:"username"}},[n("el-input",{attrs:{placeholder:"Username"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"roles"}},[n("el-select",{attrs:{multiple:"",placeholder:"Roles"},model:{value:e.registerForm.roles,callback:function(t){e.$set(e.registerForm,"roles",t)},expression:"registerForm.roles"}},e._l(e.rolesList,function(e){return n("el-option",{key:e.id,attrs:{value:e.id,label:e.rolename}})}))],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("Register")])],1)],1)},staticRenderFns:[]};var Ee=n("VU/8")(Me,Ce,!1,function $e(e){n("K6Ts")},"data-v-f835fd7e",null).exports;s.default.use(A.a);var Pe=[{path:"/",name:"Main",component:D,meta:{localname:"Main page"}},{path:"/login",name:"Login",component:z,meta:{localname:"Login page"}},{path:"/profile/:id?",name:"Profile",component:Y,meta:{localname:"Profile page"},props:!0},{path:"/settings",name:"Settings",component:Q,meta:{localname:"Settings page"}},{path:"/accounts",name:"Accounts",component:te,meta:{localname:"Accounts page"}},{path:"/accounts-income",name:"AccountsIncome",component:ie,meta:{localname:"Income accounts page"}},{path:"/accounts-current",name:"AccountsCurrent",component:le,meta:{localname:"Current accounts page"}},{path:"/accounts-expense",name:"AccountsExpense",component:fe,meta:{localname:"Expense accounts page"}},{path:"/transactions",name:"Transactions",component:ve,meta:{localname:"Transactions page"}},{path:"/users",name:"Users",component:Ae,meta:{localname:"Users page"}},{path:"/register",name:"Register",component:Ee,meta:{requiresRoles:["admin"],localname:"Register page"}}],Le=new A.a({routes:Pe});Le.beforeEach(function(e,t,n){var s=!!f.state.user;return s?s?T.checkLifetime().then(function(){return"Login"===e.name?n({name:"Main"}):function t(e,n,s){if(!e.meta.requiresRoles)return s();f.state.user.roles.split(",").some(function(t){return e.meta.requiresRoles.includes(t)})?s():s({name:"Main"})}(e,0,n)}).catch(function(e){return f.commitLogout(),n({name:"Login"})}):void 0:"Login"!==e.name?n({name:"Login"}):n()});var Te=Le,Se=s.default.extend({name:"TheHeader",data:function(){return{md:new x.a(navigator.userAgent)}},computed:{user:function(){return f.state.user}},methods:{handleCommand:function(e){if("Logout"===e)return U.showConfirmMessage("Logout","Are you sure to logout?").then(function(){f.commitLogout(),Te.push({name:"Login"})}).catch(function(){});Te.push({name:e})}}}),Ve={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-header",{staticClass:"the-header"},[n("el-row",[n("el-col",{attrs:{span:8}},[n("h4",[e._v("The Header")])]),e._v(" "),n("el-col",{attrs:{span:16}},[n("el-row",{attrs:{type:"flex",justify:"end"}},[e.user?n("el-dropdown",{attrs:{trigger:e.md.mobile()?"click":"hover"},on:{command:e.handleCommand}},[n("div",{staticClass:"el-dropdown-link"},[n("span",[e._v(e._s(e.user.username))]),e._v(" "),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"Profile"}},[n("i",{staticClass:"el-icon-info el-icon--left"}),e._v(" "),n("span",[e._v("Profile")])]),e._v(" "),n("el-dropdown-item",{attrs:{command:"Settings"}},[n("i",{staticClass:"el-icon-setting el-icon--left"}),e._v(" "),n("span",[e._v("Settings")])]),e._v(" "),n("el-dropdown-item",{attrs:{command:"Logout",divided:""}},[n("i",{staticClass:"el-icon-arrow-right el-icon--left"}),e._v(" "),n("span",[e._v("Logout")])])],1)],1):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var De=n("VU/8")(Se,Ve,!1,function Ne(e){n("u9lV")},"data-v-e5ecdb40",null).exports,Ie=s.default.extend({name:"TheFooter"}),je={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-footer",[t("h3",[this._v("The Footer")])])},staticRenderFns:[]};var ze=n("VU/8")(Ie,je,!1,function Oe(e){n("5JrK")},"data-v-6fc60404",null).exports,Be=s.default.extend({name:"TheLayout",components:{TheHeader:De,TheAside:v,TheFooter:ze},computed:{isAuthorized:function(){return!!f.state.user}}}),We={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isAuthorized?n("el-container",[n("the-header"),e._v(" "),n("the-aside"),e._v(" "),n("el-main",[n("h1",[e._v(e._s(this.$router.currentRoute.meta.localname))]),e._v(" "),e._t("default")],2),e._v(" "),n("the-footer")],1):n("el-container",[e._t("default")],2)},staticRenderFns:[]};var Ke=n("VU/8")(Be,We,!1,function Ye(e){n("g7Mu")},"data-v-5f79bcc0",null).exports,Ge=s.default.extend({name:"App",components:{TheLayout:Ke}}),He={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("the-layout",[t("router-view")],1)],1)},staticRenderFns:[]};var Je=n("VU/8")(Ge,He,!1,function Qe(e){n("PNa4")},null,null).exports,Ze=n("wUZ8"),Xe=n.n(Ze),et=(n("tvR6"),n("d8/S"),n("NYxO")),tt=n("424j");s.default.use(et.b);var nt={plugins:[Object(tt.a)()],strict:!1},st=Object(r.a)().vuexStore(nt),rt=n("DmT9"),it=n.n(rt)()("https://server.grigoblin.ru",{query:{token:f.state.accessToken}});({connect:function ot(){console.log("connect()"),it.on("connect",function(){C.log("socket connected "+it.id);var e=f.state.accessToken;C.log({token:e}),it.emit("authorize",{token:e},function(e){console.log(e)})}),it.on("disconnect",function(){C.log("socket disconnected")}),it.on("error",function(e){C.error(e.message)})}}).connect(),s.default.config.productionTip=!1,s.default.use(F.a,{locale:Xe.a}),s.default.use(y.a),console.log(Object({NODE_ENV:"production"})),new s.default({el:"#app",router:Te,store:st,render:function(e){return e(Je)}})},x8S2:function(e,t){}},["x35b"]);
//# sourceMappingURL=app.a13ca655205a926181c3.js.map